name: 'Body Tag Extractor'
author: 'TheBurchBlog'
description: 'The goal is to replicate tags like `fixes:` but make those variables exposed to the other actions through environment variables.'
inputs:
  tag:
    description: 'The tag placed inside the Body of the Issue or Pull Request before the value is defined'
    required: false
    default: 'body-tag'
  env-variable:
    description: 'The environment variable to map the tag value to'
    required: false
    default: 'body-tag'
  default-value:
    description: 'If the tag is not found, the default value to be provided'
    required: false
    default: null

outputs:
  tag-value:
    description: 'The Tag value assigned'

env:
    tags: null

runs:
  using: "composite"
  steps:
    - name: Extract Tag
      env:
        CONTAINS_TAG = ${{contains(github.event.issue.body, 'body-tag:')}}
        TAGS = []
      run: |
        [[echo ${{ github.event.issue.body }} | grep -Po "(?<=body-tag:\s)(\w+)"]] >> $env.TAGS
        echo $env.TAGS[0]
      shell: bash

